<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta name="apple-touch-fullscreen" content="YES">
    <meta name="format-detection" content="telephone=no">
    <META HTTP-EQUIV="imagetoolbar" CONTENT="no" />
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="pragram" content="no-cache">
    <title>惠开车</title>
    <link rel="stylesheet" type="text/css" href="../../styles/common.css" />
    <link rel="stylesheet" type="text/css" href="../../styles/style1.css" />
    <script>
    if (/iP(hone|od|ad)/.test(navigator.userAgent)) {  
        var v = (navigator.appVersion).match(/OS (\d+)_(\d+)_?(\d+)?/), version = parseInt(
                v[1], 10);
        if (version >= 8) {
            document.documentElement.classList.add('hairlines')
        }
    };
    </script>
</head>
<body>
    <section>
        <article>
                <div class="city-choose">
                        
                </div>
        </article>
    </section>
    <div  style="display:none">
				<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1257133697'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s11.cnzz.com/z_stat.php%3Fid%3D1257133697' type='text/javascript'%3E%3C/script%3E"));</script>
	</div>
</body>
<script type="text/javascript" src="../../js/zepto.min.js"></script>
<script type="text/javascript" src="../../librarys/nav/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="../../js/jquery.params.js"></script>
<script type="text/javascript" src="../../js/hbcommon.js"></script>
<script>
$(function(){
	//addHeader("选择年款");
	
    var brandid = $.query.get("brandid");
    var brandname = $.query.get("brandname");
    var firmid = $.query.get("firmid");
    var firmname = $.query.get("firmname");
    
    var seriesid = $.query.get("seriesid");
    var seriesname = $.query.get("seriesname");
    
    var datas = $.query.get("datas");
    var vehicleOwnerId=getGetPar("hkcVehicleOwnerInfoId");
    var vehicleId =getGetPar("hkcVehicleInfoId");
    var from = getGetPar("from");
    
    addHeader(firmname+seriesname);
    
    var params = "parentId="+seriesid;
    var urls= "/HKCIBY/hkcBrandSeries/queryYearsHkcBrandSeries.action";
    $.ajax({
        type: "post",
        url: urls,
        cache : false,
        dataType : "json",
        data : params,
        beforeSend: function (){
            loading();
        },
        success:function (data){
        	closeLoading();
        	var allitems ="" ;
        	$.each(data.yearStyles,function(m,n){
        		var items ="" ;
    			var head = "<div class=\"hd\">"+n+"</div>" ;
    			
    			var lisBefore ="<div class=\"bd\"><ul class=\"city-choose-item\">";
    			var lisAfter = "</ul></div>" ;
    			var lis ="";
    						
            	$.each(data.result,function(i,j){
            		if(n==j.yearStyle){
            			var li = "<li><a href=\"#\">"+
      				  			"<span brandid='"+brandid+"'  brandname='"+brandname+"' firmid='"
   				   				 +firmid+"'  firmname='"+firmname+"' seriesid='"
      				    		+seriesid+"'  seriesname='"+seriesname+"'  typeName='"+j.brandTypeName+"'  brandSeriesName='"+j.brandSeriesName+"' yearid='"+j.brandSeriesId+"'>"+j.nodeName+"</span></a></li>" ;
      					lis = lis + li ;
            		}
    			});
            	
            	if(lis.length>1){
    				item = lisBefore +lis+lisAfter ;
    			}
            	items = items + head + item ;
				
            	allitems = allitems + items ;
			});
			
			$(".city-choose").html("");
			$(".city-choose").append(allitems); 
			
			 //增加点击事件处理
		    $(".city-choose li").unbind("click");
			$(".city-choose li").click(function(){ 
				var brandid =$(this).find("span").attr("brandid") ;
				var brandname =$(this).find("span").attr("brandname") ;
				var firmid =$(this).find("span").attr("firmid") ;
				var firmname =$(this).find("span").attr("firmname") ;
				var seriesid =$(this).find("span").attr("seriesid") ;
				var seriesname =$(this).find("span").attr("seriesname") ;
				var yearid =$(this).find("span").attr("yearid") ;
				var yearname = $(this).find("span").text() ;
				var brandSeriesName = $(this).find("span").attr("brandSeriesName") ;
				var typeName = $(this).find("span").attr("typeName") ;
				
                if(from == "intro"){
                    window.location.href = "buy_tc.html?brandid=" + brandid +"&brandname="+ brandname
                                            +"&firmid="+ firmid+"&firmname="+ firmname
                                            +"&seriesid="+ seriesid+"&seriesname="+ seriesname
                                            +"&yearid="+ yearid+"&yearname="+ yearname
                                            +"&datas="+ datas +"&brandSeriesName="+ brandSeriesName
                                            +"&typeName="+ typeName+ "&hkcVehicleOwnerInfoId=" + vehicleOwnerId+"&channel="+channel+"&externalUniqueId="+externalUniqueId;
                }else if(from == "index"){
                    $.post("/HKCIBY/hkcVehicleOwnerInfo/newVehicleInfoHkcVehicleOwnerInfo.action",
                           {hkcVehicleOwnerInfoId: vehicleOwnerId,
                            brand: brandname,
                            firm: firmname,
                            series: seriesname,
                            year: yearid,
                            brandSeriesName: brandSeriesName,
                            typeName: typeName},
                            function (data){
                                if(data.status == "1"){
                                    window.location.href = "index.html?hkcVehicleOwnerInfoId=" + vehicleOwnerId + "&hkcVehicleInfoId=" + data.hkcVehicleInfoId;
                                }
                            });
                }else{
                    window.location.href = from + ".html?brandid="+brandid +"&brandname="+ brandname
                                            +"&firmid="+ firmid+"&firmname="+ firmname
                                            +"&seriesid="+ seriesid+"&seriesname="+ seriesname
                                            +"&yearid="+ yearid+"&yearname="+ yearname
                                            +"&datas="+ datas +"&brandSeriesName="+ brandSeriesName
                                            +"&typeName="+ typeName+ "&hkcVehicleOwnerInfoId="+vehicleOwnerId;
                }
				
			});
				
        }
    });
    
   
    
});
</script>
</html>